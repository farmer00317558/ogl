# 规范名称：OpenGen Link Protocol (OGL)

**全称**：Open Generative Deep-Link Protocol
**中文名称**：开放生成式深度链接协议
**版本**：v1.0.0
**协议类型**：URL Query Parameter Standard / URI Scheme

## 1. 协议概述 (Abstract)

**OpenGen Link (OGL)** 是一种基于 HTTP/HTTPS URL 参数的开放标准，旨在解决生成式 AI 内容社区（Prompt Library）与生成工具（Inference Platform）之间的互操作性问题。

本协议定义了一套标准化的参数命名规范，允许源网站（Source）通过构建标准 URL，将提示词（Prompt）、模型配置（Model Config）及生成参数（Generation Params）无缝传递给目标网站（Target），实现“一键跳转并填充”。

## 2. 设计原则 (Design Principles)

1.  **平台无关性 (Platform Agnostic)**：不绑定特定厂商（如 Midjourney 或 SD），而是定义通用的生成原语。
2.  **可扩展性 (Extensible)**：不仅支持文生图（T2I），预留文生视频（T2V）、音频（T2A）接口。
3.  **优雅降级 (Graceful Degradation)**：目标网站若不支持某些高级参数，应自动忽略，但必须保留核心提示词。
4.  **易读性 (Human Readable)**：优先使用语义化的 Key-Value 对，而非加密字符串。

## 3. URL 构造规范 (URL Construction)

一个符合 OGL 规范的链接由 **Base URL** 和 **Query Parameters** 组成。

### 格式

```text
https://{target-site.com}/create?ogl_ver=1.0&prompt={encoded_string}&{optional_params}
```

- 为了避免与目标网站现有的参数冲突，建议（但不强制）目标网站支持 `ogl_` 前缀，或者将本规范定义的 Key 映射到其内部参数。
- 所有值必须经过 `URL Encode` 处理。

## 4. 参数字典 (Parameter Dictionary)

### 4.1. 核心元数据 (Core Metadata)

| 参数 Key     | 类型   | 说明                                        | 示例                 |
| :----------- | :----- | :------------------------------------------ | :------------------- |
| `ogl_ver`    | String | 协议版本号                                  | `1.0`                |
| `ogl_source` | String | 来源网站名称（用于归因）                    | `civitai`, `flowgpt` |
| `action`     | String | 期望行为：`fill` (仅填充), `run` (自动运行) | `fill`               |

### 4.2. 通用生成参数 (General Generation)

适用于大多数模态（图、视频、3D）。

| 参数 Key          | 类型   | 必填   | 说明                                            |
| :---------------- | :----- | :----- | :---------------------------------------------- |
| `prompt`          | String | **是** | 正向提示词                                      |
| `negative_prompt` | String | 否     | 负向提示词                                      |
| `model`           | String | 否     | 模型标识符，必须使用 4.2.1 节定义的标准模型标识 |
| `model_hash`      | String | 否     | 模型哈希值 (用于精确匹配)                       |
| `seed`            | Int    | 否     | 随机种子 (-1 为随机)                            |

#### 4.2.1. 标准模型列表 (Standard Model List)

为确保跨平台互操作性，`model` 参数必须使用以下标准化的模型标识符。平台应将这些标识符映射到其内部模型实现。

| 模型名称            | 模型标识                       | 类型 | 说明             |
| :------------------ | :----------------------------- | :--- | :--------------- |
| Nano Banana Pro     | `gemini-3-pro-image-preview`   | 图像 | 高性能图像生成   |

**使用规范**：
- `model` 参数值必须严格使用"模型标识"列中的值
- 平台收到未识别的模型标识时，应回退到默认模型或提示用户
- 不支持自定义模型路径或非标准命名

### 4.3. 图像专用扩展 (Image Extension)

| 参数 Key       | 类型   | 说明                                   |
| :------------- | :----- | :------------------------------------- |
| `width`        | Int    | 宽度 (px)                              |
| `height`       | Int    | 高度 (px)                              |
| `aspect_ratio` | String | 宽高比 (如 `16:9`, `1:1`)，优先级高于 w/h |

### 4.4. 视频专用扩展 (Video Extension)

| 参数 Key        | 类型   | 说明                     |
| :-------------- | :----- | :----------------------- |
| `duration`      | Float  | 视频时长 (秒)            |
| `fps`           | Int    | 帧率                     |
| `camera_motion` | String | 运镜描述 (如 `pan_left`) |

## 5. 交互流程示例

### 场景：用户在 PromptHub 看到一张好图，想去 SDWebUI 生图

1.  **用户**点击 PromptHub 上的“在 MyGenSite 运行”按钮。
2.  **PromptHub** 构造链接：
    ```
    https://mygensite.com/workspace?ogl_ver=1.0&action=fill&prompt=cat%20in%20space&model=sdxl_1.0&aspect_ratio=16:9
    ```
3.  **MyGenSite** 接收请求，解析 URL 参数。
4.  **MyGenSite** 将 `cat in space` 填入输入框，自动选择 `SDXL 1.0` 模型，并将画布调整为 `16:9`。
5.  **用户** 点击生成。

## 6. 开发者指南 (Implementation Guide)

### 对于提示词网站 (Source)

- 提供一个配置页面，允许用户填写他们常用的生图网站 Base URL（例如 `http://127.0.0.1:7860` 或 `https://midjourney.com`）。
- 生成链接时，确保对所有 Value 进行 URI Component Encoding。

### 对于生图网站 (Target)

- **解析逻辑**：在页面加载（`window.onload`）时检查 `location.search`。
- **参数映射**：建立一个简单的映射表，将 OGL 标准参数映射到自身 UI 组件的 State 中。
- **安全检查**：如果 `action=run`，建议弹出确认框，防止恶意消耗用户点数（Credits）。

## 7. 扩展性与未来 (Future Proofing)

为了让这个规范更专业，你可以设立一个 GitHub 仓库（例如命名为 `opengen-link-spec`），包含：

1.  **README.md**: 上述规范文档。
2.  **Badge**: 设计一个 "OGL Compatible" 的徽章，供支持该协议的网站挂在页脚。
